# 第1回 Gitハンズオン勉強会

## アジェンダ

1. 本勉強会についての説明
1. Git、Githubについて簡単な説明
1. 基本的なGitコマンド操作の学習①
    * リモートリポジトリのcloneからpushまで
    * ブランチを切って、merge、pushまで
1. 基本的なGitコマンド操作の学習② （※時間があれば）
    * ローカルリポジトリの作成からリモートリポジトリへのpushまで

## What is Git ? What is Github ?

### Git

* https://git-scm.com/
* 分散型バージョン管理システム
* 全履歴を含んだリポジトリの完全な複製をローカルに持つ
    * リモートリポジトリ、ローカルリポジトリ
    * オフラインでも作業が可能
* 柔軟なブランチ操作
* 柔軟なワークフロー
    * Git Flow
    * Github Flow

### Github

* https://github.com/
* ソフトウェア開発プロジェクトのためのソース管理・共有ウェブサービス
    * 現代のソース管理・共有サービスのデファクト
* バージョン管理システムにGitを採用
* 分かりやすいUI
* Issue によるタスク管理
* Pull Request により誰でもソースコードへのcontributeが可能
    * 開発者同士のコミュニケーション
    * コードレビューの文化
* API 及び Webhook による多様な外部サービスとの連携

## 基本的なGitコマンド操作

### 事前準備

* Github上に、`study-git`リポジトリを作成する
* `~/.gitconfig`を作成

    ```
    [user]
        name = Githubのユーザ名
        email = Githubのメールアドレス
    [url "https://"]
        insteadOf = git://
    [color]
        ui = auto
    [merge]
        ff = false
    ```

### リモートリポジトリのcloneからpushまで

#### 1. リモートリポジトリのclone

リモートリポジトリをローカルに複製します。

```bash
git clone <リモートリポジトリのURL>
```

*実行例*

```bash
# リモートリポジトリをclone
git clone https://github.com/kawanamiyuu/study-git.git
cd study-git

# リモートリポジトリの情報を確認
git remote -v

# リポジトリに含まれるブランチを確認
git branch -a
```

#### 2. ソースコードの編集

*実行例*

```bash
cd study-git
vi README.md
```

#### 3. ローカルリポジトリへのcommit

```bash
git add [<file> ...]
git commit [-m "コミットメッセージ"]
```

2つのコマンドにはそれぞれ

* `git add` →　変更したファイルをステージングエリアに追加し、次回のコミットの対象とする
* `git commit` → ステージングエリアにあるファイルをローカルリポジトリにコミットする

という意味がありますが、`add`と`commit`は通常セットで実行するため、あまり厳密に考える必要はありません。

*実行例*

```bash
# 変更が発生したファイルを確認
git status

# コミット
git add .
git commit

# コミットログを確認
git log --stat
```

* `git add .`とすると、変更したすべてのファイルがコミットの対象になります
* コミットメッセージを省略して`git commit`を実行すると、コミットメッセージ入力画面(`vi`)が立ち上がります
    

#### 4. リモートリポジトリへのpush

ローカルで行った変更をリモートリポジトリに反映します。

```bash
git push origin <ブランチ名>
```

*実行例*

```bash
git push origin master
```

Githubのリポジトリに、コミットした内容が反映されていることを確認してください。

### ブランチを切って、merge、pushまで

#### 1. ブランチを切る

```bash
git checkout -b <new branch> [<base branch>]
```

* `base branch`から`new branch`を作成し、作業ブランチを`new branch`に切り替えます
* `base branch`を省略した場合、カレントブランチから`new branch`を作成します

*実行例*

```bash
# カレントブランチ(master)からdevelopブランチを作成し、作業ブランチをdevelopブランチに切り替え
git checkout -b develop

# ブランチ確認
# *が付いているのがカレントブランチ
git branch
* develop
  master
```

##### (補足) 

上記の`git checkout -b <new branch> [<base branch>]`は次の2つのコマンドを連続して実行したのと同じ

```bash
git branch <new branch> [<base branch>]
git checkout <new branch>
```

*実行例*

```bash
# masterブランチからdevelopブランチを作成
git branch develop master

# ブランチ確認（カレントブランチはまだmaster）
git branch
  develop
* master

# 作業ブランチをdevelopブランチに切り替え
git checkout develop

# ブランチ確認（カレントブランチはdevelop）
git branch
* develop
  master
```

#### 2. 作成したブランチでソースコードの編集＆commit

*実行例*

```bash
git checkout develop

# 既存のファイルを更新
vi README.md
# 新しいファイルを追加
touch newfile.txt

# 変更が発生したファイルを確認
git status

# diffを確認
git diff

git add .
git commit
```

#### 3. ブランチのmerge

```bash
git merge <ブランチ名>
```

* 指定したブランチをカレントブランチにマージコミットします
* マージコミットメッセージ入力画面が立ち上がります

*実行例*

```bash
# masterブランチに切り替え
git checkout master

# 変更前のソースコードであることを確認
# README.mdが未更新、newfile.txtが存在しない
less README.md
ls .

# developブランチとのdiffを確認
git diff develop

# developブランチをmasterブランチにマージ
git merge develop

# 変更後のソースコードであることを確認
# README.mdが更新済み、newfile.txtが存在する
less README.md
ls .

# ログを確認
git log --graph --oneline
```

#### 4. リモートリポジトリへのpush

*実行例*

```bash
git push origin master

# マージ済みの不要なブランチを削除
git branch -d develop
```

Githubのリポジトリに、マージしたブランチの内容が反映されていることを確認してください。

### ローカルリポジトリの作成からリモートリポジトリへのpushまで

#### 1. リモートリポジトリの作成

* Github上に`study-git2`リポジトリを作成します

#### 2.  ローカルリポジトリの作成

カンレントディレクトリをGitリポジトリとして初期化します。

```bash
git init
```

*実行例*

```bash
mkdir study-git2
cd study-git2
git init
```

#### 3. ソースコードの編集＆commit

*実行例*

```bash
vi README.md
git add .
git commit
```

#### 4. リモートリポジトリの登録

ローカルリポジトリに対応する、リモートリポジトリのURLを登録します。

```bash
git remote add origin <リモートリポジトリのURL>
```

*実行例*

```bash
# リモートリポジトリの情報を確認（結果は空）
git remote -v

# originとしてリモートリポジトリを登録
git remote add origin https://github.com/kawanamiyuu/study-git2.git

# リモートリポジトリの情報を確認
git remote -v
```

#### 5. リモートリポジトリへのpush

*実行例*

```bash
git push origin master
```

Githubのリポジトリに反映されていることを確認してください。

